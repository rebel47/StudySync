<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>StudySync - Study App</title>
    <link rel="preconnect" href="https://fonts.gstatic.com">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="styles.css?v=1.0.3">
</head>
<body>
<header class="app-header">
    <div class="brand">StudySync</div>
    <div class="actions">
        <div id="user-area" class="user-area">
            <img id="user-photo" class="avatar hidden" alt="User avatar" />
            <span id="user-name" class="user-name hidden"></span>
            <button id="sign-in-btn" class="btn ghost">Sign in</button>
            <button id="sign-out-btn" class="btn ghost hidden">Sign out</button>
        </div>
        <!-- Add settings icon after user area -->
        <button id="settings-btn" class="btn ghost settings-btn" title="Timer Settings">
            ‚öôÔ∏è
        </button>
    </div>
</header>


    <main class="container">
        <!-- Study Session Panel -->
        <section class="panel">
            <div class="panel-header">
                <h1>Study Session</h1>
                <div class="session-controls">
                    <button id="create-session-btn" class="btn primary">Create Room</button>
                    <button id="join-session-btn" class="btn ghost">Join Room</button>
                    <button id="leave-session-btn" class="btn ghost hidden">Leave Room</button>
                </div>
            </div>

            <div id="session-area" class="session-area">
                <div id="session-info" class="session-info hidden">
                    <div class="session-meta">
                        <span id="session-id" class="session-id" title="Click to copy session code"></span>
                        <div id="participants-avatars" class="participants-avatars"></div>
                    </div>
                </div>

                <!-- Pomodoro Timer! -->
                <div class="timer-container">
                    <div id="timer-display" class="timer-display">
                        <div class="timer-ring">
                            <svg class="timer-svg" viewBox="0 0 120 120">
                                <circle class="timer-bg" cx="60" cy="60" r="54" fill="none" stroke="rgba(255,255,255,0.1)" stroke-width="8"/>
                                <circle id="timer-progress" class="timer-progress" cx="60" cy="60" r="54" fill="none" stroke="url(#gradient)" stroke-width="8" stroke-linecap="round" transform="rotate(-90 60 60)"/>
                                <defs>
                                    <linearGradient id="gradient" x1="0%" y1="0%" x2="100%" y2="0%">
                                        <stop offset="0%" style="stop-color:#7c5cff"/>
                                        <stop offset="100%" style="stop-color:#00d4ff"/>
                                    </linearGradient>
                                </defs>
                            </svg>
                        </div>
                        <div class="timer-content">
                            <div id="timer-time" class="timer-time">25:00</div>
                            <div id="timer-mode" class="timer-mode">Focus</div>
                        </div>
                    </div>
                    <div class="timer-controls">
                        <button id="start-timer" class="btn primary">Start</button>
                        <button id="pause-timer" class="btn ghost hidden">Pause</button>
                        <button id="reset-timer" class="btn ghost">Reset</button>
                        <button id="focus-mode-btn" class="btn ghost">Focus Mode</button>
                    </div>
                </div>
            </div>
        </section>

        <!-- Notes Panel -->
        <section class="panel">
            <div class="panel-header">
                <h1>Notes</h1>
                <button id="add-note-btn" class="btn primary">+ New</button>
            </div>

            <div id="notes-grid" class="notes-grid">
                <!-- notes will render here -->
                <div id="loading" class="loading hidden">Loading‚Ä¶</div>
            </div>
        </section>
    </main>

    <!-- Chat Panel -->
    <div id="chat-panel" class="chat-panel hidden">
        <div class="chat-header">
            <div class="chat-header-title">
                <svg class="chat-header-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"></path>
                </svg>
                <h3>Study Chat</h3>
            </div>
            <button id="close-chat" class="chat-close-btn">√ó</button>
        </div>
        <div id="chat-messages" class="chat-messages"></div>
        <form id="chat-form" class="chat-form">
            <input id="chat-input" type="text" placeholder="Type a message..." maxlength="200" />
            <button type="submit" class="chat-send-btn">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <line x1="22" y1="2" x2="11" y2="13"></line>
                    <polygon points="22 2 15 22 11 13 2 9 22 2"></polygon>
                </svg>
            </button>
        </form>
    </div>

    <!-- Chat Toggle -->
    <button id="chat-toggle" class="chat-toggle hidden">
        <svg class="chat-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"></path>
        </svg>
        <span id="unread-count" class="unread-count hidden">0</span>
    </button>

    <!-- Focus Mode Overlay -->
    <div id="focus-mode" class="focus-mode hidden">
        <button class="focus-close" onclick="exitFocusMode()">√ó</button>
        <div class="focus-timer">
            <div class="focus-timer-ring">
                <svg class="timer-svg" viewBox="0 0 200 200">
                    <circle class="timer-bg" cx="100" cy="100" r="90" fill="none" stroke="rgba(255,255,255,0.1)" stroke-width="12"/>
                    <circle id="focus-timer-progress" class="timer-progress" cx="100" cy="100" r="90" fill="none" stroke="url(#gradient)" stroke-width="12" stroke-linecap="round" transform="rotate(-90 100 100)"/>
                </svg>
            </div>
            <div class="focus-timer-content">
                <div id="focus-timer-time" class="focus-timer-time">25:00</div>
                <div id="focus-timer-mode" class="focus-timer-mode">Focus</div>
            </div>
        </div>
        <div class="focus-controls">
            <button id="focus-start" class="btn primary large">Start</button>
            <button id="focus-pause" class="btn ghost large hidden">Pause</button>
            <button id="focus-reset" class="btn ghost large">Reset</button>
        </div>
        <div class="focus-exit">Press ESC or Ctrl+F to exit focus mode</div>
    </div>

    <!-- Join Session Modal -->
    <div id="join-modal" class="modal hidden">
        <div class="modal-content">
            <h3>Join Study Session</h3>
            <input id="session-code-input" type="text" placeholder="Enter session code" class="session-input" />
            <div class="modal-actions">
                <button id="cancel-join" class="btn ghost">Cancel</button>
                <button id="confirm-join" class="btn primary">Join</button>
            </div>
        </div>
    </div>

    <!-- Start Study Modal -->
    <div id="start-study-modal" class="modal hidden">
        <div class="modal-content">
            <h3>How would you like to study?</h3>
            <p class="modal-description">Choose your study mode to get started</p>
            <div class="study-options">
                <button id="study-solo-btn" class="btn study-option">
                    <div class="option-icon">üìö</div>
                    <div class="option-text">
                        <h4>Study Solo</h4>
                        <p>Focus mode with Pomodoro timer</p>
                    </div>
                </button>
                <button id="create-room-btn" class="btn study-option">
                    <div class="option-icon">üë•</div>
                    <div class="option-text">
                        <h4>Create Study Room</h4>
                        <p>Collaborate with friends in real-time</p>
                    </div>
                </button>
                <button id="join-room-btn" class="btn study-option">
                    <div class="option-icon">üîó</div>
                    <div class="option-text">
                        <h4>Join Study Room</h4>
                        <p>Enter a session code to join friends</p>
                    </div>
                </button>
            </div>
            <div class="modal-actions">
                <button id="cancel-start" class="btn ghost">Cancel</button>
            </div>
        </div>
    </div>

    <!-- Add / Edit Note Drawer -->
    <div id="drawer" class="drawer hidden">
        <form id="note-form" class="note-form">
            <label class="field">
                <span class="label">Title</span>
                <input id="note-title" type="text" placeholder="Short, clear title" required />
            </label>
            <label class="field">
                <span class="label">Content</span>
                <textarea id="note-content" rows="6" placeholder="Write your note..." required></textarea>
            </label>
            <div class="form-actions">
                <button type="button" id="cancel-btn" class="btn ghost">Cancel</button>
                <button type="submit" class="btn primary">Save</button>
            </div>
        </form>
    </div>
<div id="settings-modal" class="modal hidden">
    <div class="modal-content settings-modal-content">
        <div class="modal-header">
            <h3>Timer Settings</h3>
            <button id="close-settings" class="btn ghost small">√ó</button>
        </div>
        
        <div class="settings-sections">
            <!-- Time Settings -->
            <div class="settings-section">
                <h4>‚è∞ Timer Durations (minutes)</h4>
                <div class="time-inputs">
                    <div class="time-input-group">
                        <label>Pomodoro</label>
                        <input id="pomodoro-time" type="number" min="1" max="60" value="25" class="time-input" />
                    </div>
                    <div class="time-input-group">
                        <label>Short Break</label>
                        <input id="short-break-time" type="number" min="1" max="30" value="5" class="time-input" />
                    </div>
                    <div class="time-input-group">
                        <label>Long Break</label>
                        <input id="long-break-time" type="number" min="1" max="60" value="15" class="time-input" />
                    </div>
                </div>
            </div>

            <!-- Auto Start Settings -->
            <div class="settings-section">
                <h4>üîÑ Auto Start</h4>
                <div class="toggle-group">
                    <label class="toggle-item">
                        <span>Auto Start Breaks</span>
                        <div class="toggle-switch">
                            <input id="auto-start-breaks" type="checkbox" />
                            <div class="toggle-slider"></div>
                        </div>
                    </label>
                    <label class="toggle-item">
                        <span>Auto Start Pomodoros</span>
                        <div class="toggle-switch">
                            <input id="auto-start-pomodoros" type="checkbox" />
                            <div class="toggle-slider"></div>
                        </div>
                    </label>
                </div>
            </div>

            <!-- Long Break Interval -->
            <div class="settings-section">
                <h4>üìä Long Break Interval</h4>
                <div class="interval-setting">
                    <label>Long break every</label>
                    <input id="long-break-interval" type="number" min="2" max="10" value="4" class="interval-input" />
                    <span>pomodoros</span>
                </div>
            </div>
        </div>

        <div class="modal-actions">
            <button id="reset-settings" class="btn ghost">Reset to Default</button>
            <button id="save-settings" class="btn primary">Save Settings</button>
        </div>
    </div>
</div>
    <!-- Firebase SDKs (compat) -->
    <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-firestore-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-database-compat.js"></script>

    <script src="app.js?v=1.0.5"></script>
</body>
</html>